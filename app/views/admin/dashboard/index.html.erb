<%= vite_typescript_tag 'entrypoints/admin/index.tsx' %>

<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">

  <!-- DUES EXPECTED -->
  <div class="order-1 h-48 md:h-96 xl:h-48 flex flex-col col-span-1 md:col-span-2 lg:col-span-3 xl:col-span-4">
    <%= link_to admin_payments_path, class: 'card-flat flex-grow border-gray-300 group hover:shadow-md hover:border-transparent hover:bg-gradient-to-br hover:from-green-500 hover:to-green-700 flex flex-col sm:flex-row md:flex-col justify-between place-content-stretch transition' do %>
      <div id="dues" data-expected-dues="<%= @expected_dues / 100.0 %>" data-actual-dues="<%= @actual_dues / 100.0 %>"></div>
    <% end %>
  </div>

  <!-- UPCOMING PAYMENTS -->
  <div class="max-h-48 md:max-h-96 xl:max-h-144 order-2 md:col-span-2 overflow-hidden rounded-lg">
    <div id="upcoming-payments">
    </div>
  </div>


  <!-- BEHIND MEMBERS -->
  <div class="order-2 md:order-3 lg:order-2 col-span-1 md:col-span-2 lg:col-span-1 xl:col-span-2 max-h-96 xl:max-h-48 flex flex-col">
    <div class="card-flat border-gray-300 overflow-scroll flex-grow">
      <span class="card-title text-gray-500">BEHIND MEMBERS</span>
      <ul class="divide-y divide-gray-300 dark:divide-gray-600">
        <% @behind_members.each do |member| %>
          <li>
            <%= link_to admin_user_path(member), class: 'px-5 py-4 -mx-5 flex justify-between group hover:bg-gray-300 dark:hover:bg-gray-600' do %>
              <div class="flex flex-col">
                <span class="mb-0.5"><%= member[:name] %></span>
                <% if member[:last_payment] %>
                  <span class="text-sm font-medium text-gray-500 hidden xl:inline">
                    Last paid <%= number_to_currency(member[:last_payment].amount / 100.0) %> on <%= member[:last_payment].date_paid.strftime('%a, %-m/%-d') %>
                  </span>
                <% end %>
              </div>
              <div>
                <span class="bg-red-100 text-red-600 rounded-full text-sm font-medium px-3 py-1">-<%= number_to_currency(member[:behind] / 100.0) %></span>
              </div>
            <% end %>
          </li>
        <% end %>
      </ul>
    </div>
  </div>


  <!-- UPCOMING CONFLICTS -->
  <div class="order-5 row-span-2 col-span-1 md:col-span-2 lg:col-span-3 xl:col-span-4">
    <div class="card-flat border-gray-300">
      <span class="card-title text-gray-500">UPCOMING CONFLICTS</span>
      <div id="upcoming-conflicts"></div>
    </div>
  </div>
</div>
