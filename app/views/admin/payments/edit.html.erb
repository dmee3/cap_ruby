<div class="row">
  <div class="col-md-9">
    <h1>Edit Payment for <%= @payment.user.first_name %></h1>
  </div>
  <div class="col-md-3 text-right-md">
    <%= link_to 'All Payments', admin_payments_path, class: 'btn btn-light align-middle' %>
  </div>
</div>

<div class="card">
  <%= form_for @payment, url: admin_payment_path(@payment), html: { class: 'card-body' } do |p| %>
    <div class="row mt-3">
      <div class="col-md-4 form-group">
        <%= p.collection_select :payment_type_id, PaymentType.all, :id, :name, {}, { class: 'form-control select2-form-control' } %>
      </div>
      <div class="col-md-4">
        <div class="input-group">
          <div class="input-group-prepend">
            <span class="input-group-text">$</span>
          </div>
          <%= p.number_field :amount, placeholder: '0.00', step: :any, class: 'form-control' %>
        </div>
      </div>
      <div class="col-md-4 form-group">
        <%= p.text_field :date_paid, { class: 'flatpickr form-control mr-2 mb-2 w-100' } %>
      </div>
    </div>

    <div class="row mt-3">
      <div class="col-12 form-group">
        <%= p.text_area :notes, { class: 'form-control', placeholder: 'Notes' } %>
      </div>
    </div>

    <div class="row mt-3">
      <div class="col-sm-12 form-group text-center">
        <%= p.submit 'Submit', class: 'btn btn-success', id: 'payment-submit-btn' %>
      </div>
    </div>
  <% end %>
</div>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const form = document.querySelector('form');
    const submitBtn = document.getElementById('payment-submit-btn');

    form.addEventListener('submit', (e) => {
      if (submitBtn.disabled) {
        e.preventDefault();
        return false;
      }
      submitBtn.value = 'Submitting...';
      submitBtn.disabled = true;
      submitBtn.classList.add('opacity-50', 'cursor-default');
    });
  });
</script>
