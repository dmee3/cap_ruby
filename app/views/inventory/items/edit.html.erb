<div class="flex flex-col">
  <h1>Edit <%= @item.name %></h1>
</div>

<%= form_with model: @item, url: inventory_category_item_path(@category, @item) do |f| %>
  <div class="grid grid-cols-5 gap-x-6 gap-y-4">
    <div class="col-span-5 sm:col-span-1 flex items-center">
      <%= f.label :name, class: 'input-label' %>
    </div>
    <div class="col-span-5 sm:col-span-4 flex items-center">
      <%= f.text_field :name, class: 'input-text' %>
    </div>

    <div class="col-span-5 sm:col-span-1 flex items-center">
      <%= f.label :current_quantity, class: 'input-label' %>
    </div>
    <div class="col-span-5 sm:col-span-4 flex items-center">
      <%= f.number_field :current_quantity, value: @item.quantity, class: 'input-text cursor-not-allowed', disabled: true %>
    </div>

    <div class="col-span-5 sm:col-span-1 flex items-center">
      <%= f.label :quantity, class: 'input-label' %>
    </div>
    <div class="col-span-5 sm:col-span-4 flex items-center">
      <%= f.number_field :quantity, class: 'input-text' %>
    </div>

    <div class="col-span-5 sm:col-span-1 flex items-center">
      <%= f.label :performed_on, class: 'input-label' %>
    </div>
    <div class="col-span-5 sm:col-span-4 flex items-center">
      <%= f.date_field :performed_on, class: 'input-text', value: Date.today %>
    </div>
  </div>
  
  <div class="mt-4 flex flex-row justify-end">
    <%= f.submit 'Submit', class: 'btn-primary btn-lg' %>
  </div>
<% end %>

<% if @item.transactions.present? %>
  <div class="row mt-3">
    <div class="col-12">
      <div class="card">
        <ul class="list-group list-group-flush">
          <% @item.transactions.order('performed_on desc, created_at desc').each do |t| %>
            <li class="list-group-item d-flex w-100 justify-content-between text-body">
              <span><%= t.performed_on %></span>
              <span>
                <%= t.previous_quantity %>
                <span class="text-<%= t.change > 0 ? "success" : "danger" %>"><%= t.change > 0 ? "+#{t.change}" : t.change %></span>
                = <span class="font-weight-bold"><%= t.previous_quantity + t.change %></span>
            </li>
          <% end %>
        </ul>
      </div>
    </div>
  </div>
<% end %>
